{
    "contents" : "rm(list = ls())\nlibrary(C50)\nlibrary(gmodels)\nlibrary (ROCR)\n\ncredit <- read.csv(\"/home/askofen/Documents/LearningR/Data/credit.csv\", stringsAsFactors = TRUE)\ncredit$default <- factor(credit$default)\n\nstr(credit)\ntable(credit$checking_balance)\ntable(credit$savings_balance)\nsummary(credit$months_loan_duration)\nsummary(credit$amount)\ntable(credit$default)\n\n#randomly shuffle the sequence\nset.seed(12345)\ncredit_rand <- credit[order(runif(1000)), ]\n\nhead(credit$amount)\nhead(credit_rand$amount)\n\ncredit_train <- credit_rand[1:900, ]\ncredit_test <- credit_rand[901:1000, ]\n\nprop.table(table(credit_train$default))\nprop.table(table(credit_test$default))\n\ncredit_model <- C5.0(credit_train[-21], credit_train$default)\nsummary(credit_model)\n\ncredit_pred <- predict(credit_model, credit_test)\n\nCrossTable(credit_test$default, credit_pred,\n           prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,\n           dnn = c('actual default', 'predicted default'))\n\n#-------------------------------\n#ROCR Analizis\npred1 <- prediction(as.numeric(as.character(credit_test$default)), as.numeric(as.character(credit_pred)));\n# Recall-Precision curve             \nRP.perf <- performance(pred1, \"prec\", \"rec\")\nplot (RP.perf)\n# ROC curve\nROC.perf <- performance(pred1, \"tpr\", \"fpr\")\nplot (ROC.perf)\n#-------------------------------\n\ncredit_boost10 <- C5.0(credit_train[-21], credit_train$default, trials = 10)\ncredit_boost10\nsummary(credit_boost10)\n\ncredit_boost_pred10 <- predict(credit_boost10, credit_test)\nCrossTable(credit_test$default, credit_boost_pred10,\n           prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,\n           dnn = c('actual default', 'predicted default'))\n\n\n# Cost matrix use\n#-------------------------------------------\nerror_cost = matrix(c(0,1,4,0), nrow = 2)\ncredit_cost <- C5.0(credit_train[-21], credit_train$default, costs = error_cost)\ncredit_cost_pred <- predict(credit_cost, credit_test)\nCrossTable(credit_test$default, credit_cost_pred,\n           prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,\n           dnn = c('actual default', 'predicted default'))",
    "created" : 1434888502498.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "694975005",
    "id" : "821367AB",
    "lastKnownWriteTime" : 1435262924,
    "path" : "~/Documents/LearningR/DecisionTrees.R",
    "project_path" : "DecisionTrees.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}