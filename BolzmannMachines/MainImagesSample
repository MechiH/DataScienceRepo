import numpy as np
import RestrictedBolzmannMachine as rbmachine
import Image as im
from ImagesHelper import ImagesHelper as ih

sunImage = im.open("Data/Logo.bmp")
sumMask = ih.get_bit_mask_from_bitmap(sunImage)
#ih.plot_bit_mask(sumMask, 100, 100)

input_samples = np.array(sumMask)

rbm = rbmachine.RestrictedBolzmannMachine(10000, 900, 1, 5)
rbm.log_intermediate = False

rbm.train(input_samples)

hidden_sun = rbm.count_hidden(input_samples[0])
visible_sun = rbm.count_visible(hidden_sun)

ih.plot_bit_mask(hidden_sun, 30, 30)
ih.plot_bit_mask(visible_sun, 100, 100)
